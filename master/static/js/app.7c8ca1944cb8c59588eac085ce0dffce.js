var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(m){f(m)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b;})})}},"es9","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
var regressao=function(a){var b=function(a){var b=a?[parseFloat(a[0].toExponential(2)),parseFloat(a[1].toExponential(2))]:void 0;if(1E-12>Math.abs(b[1]))a=b[0].toExponential(2)+"*x";else if(0===Math.abs(b[0]))a=b[1].toExponential(2);else{var c=0<=b[1]?"*x + ":"*x - ";a=a[0].toExponential(2)+c+Math.abs(b[1]).toExponential(2)}return a},c={},d=[];if(1<a.length)for(var e=1;e<a.length;e++)d.push([a[e-1],a[e]]);else d.push([[0,0],a[0]]);c.equacaoArr=d.map(function(a,b){b={};var c=[[a[0][0],parseFloat(a[0][1].toExponential(1))],
[a[1][0],parseFloat(a[1][1].toExponential(1))]];c=regression.linear(c,{precision:16}).equation;b.termoADireita=a[1][0].toString();b.regressaoArr=c;return b});c.termosRegressao=function(a){var c={},d="se( x <= {0} ;{1} ;{2} )",e=a.length;if(1===e)c.formula=b(a[0].regressaoArr);else{for(var f=0;f<a.length;f++)d=d.replace("{0}",a[f].termoADireita).replace("{1}","\n "+b(a[f].regressaoArr)),f===a.length-1&&(d=d.replace("{2}","\n"+b(a[f].regressaoArr))),f<a.length-2&&(d=d.replace("{2}","\nse( x <= {0} ;{1} ;{2} )"));
c.formula=d.replace(/\./g,",")}c.termos=a.map(function(a,c){return{condicao:e-1===c?0===c?null:";":"se(x <= "+a.termoADireita+" ; ",regressao:b(a.regressaoArr)}});return c}(c.equacaoArr);return c};Highcharts.setOptions({lang:{months:"Janeiro Fevereiro Mar\u00e7o Abril Maio Junho Julho Agosto Setembro Outubro Novembro Dezembro".split(" "),shortMonths:"Jan Fev Mar Abr Mai Jun Jul Ago Set Out Nov Dez".split(" "),weekdays:"Domingo Segunda Ter\u00e7a Quarta Quinta Sexta S\u00e1bado".split(" "),decimalPoint:","}});
var highchartsColors="#2b908f #90ee7e #f45b5b #7798BF #aaeeee #ff0066 #eeaaee #55BF3B #DF5353 #7798BF #aaeeee #ff0000".split(" ");
Highcharts.theme={colors:highchartsColors,chart:{backgroundColor:"#324157",style:{fontFamily:"Helvetica, sans-serif"},plotBorderColor:"#606063"},title:{style:{color:"#E0E0E3",fontSize:"14px"}},subtitle:{style:{color:"#E0E0E3"}},xAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",title:{style:{color:"#A0A0A3"}}},yAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",
tickColor:"#707073",tickWidth:1,title:{style:{color:"#A0A0A3"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",style:{color:"#F0F0F0"}},plotOptions:{series:{dataLabels:{color:"#B0B0B3"},marker:{lineColor:"#333"}},boxplot:{fillColor:"#505053"},candlestick:{lineColor:"white"},errorbar:{color:"white"}},legend:{itemStyle:{color:"#E0E0E3"},itemHoverStyle:{color:"#FFF"},itemHiddenStyle:{color:"#606063"}},credits:{style:{color:"#666"}},labels:{style:{color:"#707073"}},drilldown:{activeAxisLabelStyle:{color:"#F0F0F3"},
activeDataLabelStyle:{color:"#F0F0F3"}},navigation:{buttonOptions:{symbolStroke:"#DDDDDD",theme:{fill:"#505053"}}},rangeSelector:{buttonTheme:{fill:"#505053",stroke:"#000000",style:{color:"#CCC"},states:{hover:{fill:"#707073",stroke:"#000000",style:{color:"white"}},select:{fill:"#000003",stroke:"#000000",style:{color:"white"}}}},inputBoxBorderColor:"#505053",inputStyle:{backgroundColor:"#333",color:"silver"},labelStyle:{color:"silver"}},navigator:{handles:{backgroundColor:"#666",borderColor:"#AAA"},
outlineColor:"#CCC",maskFill:"rgba(255,255,255,0.1)",series:{color:"#7798BF",lineColor:"#A6C7ED"},xAxis:{gridLineColor:"#505053"}},scrollbar:{barBackgroundColor:"#808083",barBorderColor:"#808083",buttonArrowColor:"#CCC",buttonBackgroundColor:"#606063",buttonBorderColor:"#606063",rifleColor:"#FFF",trackBackgroundColor:"#404043",trackBorderColor:"#404043"},legendBackgroundColor:"rgba(0, 0, 0, 0.5)",background2:"#505053",dataLabelsColor:"#B0B0B3",textColor:"#C0C0C0",contrastTextColor:"#F0F0F3",maskColor:"rgba(255,255,255,0.3)"};
Highcharts.setOptions(Highcharts.theme);Decimal.set({precision:15,rounding:Decimal.ROUND_HALF_EVEN});var fnSignformatter=function(a,b){return isFinite(a)?(new Decimal(a)).toSignificantDigits(b||2).toString():"Infinito"};function fnHideOnClickOutside(a){var b=function(c){!a.contains(c.target)&&fnIsVisible(a)&&(a.classList.remove("is-active"),document.removeEventListener("click",b))};document.addEventListener("click",b)}
var fnIsVisible=function(a){return!!a&&!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},fnRegreArray=function(a,b){if(1===a.length)a=a[0].regressaoArr;else{var c;a=(c=_.find(a,function(a){return b<=parseFloat(a.termoADireita)}))?c.regressaoArr:a[a.length-1].regressaoArr}return a},fnPegaDataUTCNum=function(a){return Date.UTC.apply(void 0,a.split(" ")[0].split("-"))},fnTextoEntreTags=function(a,b){var c=a.indexOf("<"+b+">"),d=a.indexOf("</"+b+">");return a.slice(c+b.length+2,d-2)},fnFmtData=
function(a,b){return b?moment(a).format("DD/MM/YYYY HH:mm:ss"):moment(a).format("DD/MM/YYYY")},fnDescItem=function(a){a=(("-"!==a.modelo&&a.modelo?""+a.modelo+", ":"")+("-"!==a.identificacao?"identifica\u00e7\u00e3o "+a.identificacao+", ":"")+("-"!==a.numeroserie?"s\u00e9rie n.: "+a.numeroserie+", ":"")+("-"!==a.patrimonio?"patrim\u00f4nio "+a.patrimonio:"")).trim();return a=a.replace(/, (?![\s\S]*, )/," e ")},fnPegaStatus=function(a,b){var c=b.periodicidade,d=b.periodicidadeAlerta,e=moment(a).add(parseInt(c.val),
c.suffixo);moment.duration(parseInt(c.val),c.suffixo).humanize();moment.duration(parseInt(c.val),c.suffixo).humanize();d=moment(a).add(parseInt(c.val),c.suffixo).subtract(d.val,d.suffixo);c=moment();if(c.isAfter(e)){var f="venceu ";var g="VENCIDO";d="is-danger"}else c.isAfter(d)?(g="ALERTA_VENCIMENTO",d="is-warning"):(g="CALIBRADO",d="is-success"),f="vence ";e=f+c.to(e)+" ("+e.format("DD/MM/YYYY")+")";"Inativo"===b.periodicidade.status&&(g="INATIVO",d="is-light");return{texto:e,textoCap:_.capitalize(e),
cor:d,situacao:g,dataUltimaCal:a}},fnQueryInstIdData=function(a){var b=this;a=a||INSTRUMENT_STORE.state.db;var c={startkey:[this.$route.params.id],endkey:[this.$route.params.id+"_\ufff0",2],reduce:!1};console.log("Obtendo analises...");a.query("analise/analise",c).then(function(a){console.log("consulta do db realizada. Executando map/reduce...");a=couchFnReduce(a.rows.map(function(a){return[a.key]}),a.rows.map(function(a){return a.value}),!1);a.configTodos=JSON.parse(JSON.stringify(a.config));a=couchFnReduce(null,
[a],!0);INSTRUMENT_STORE.update(a);console.log("Pronto")}).catch(function(a){"missing"===a.reason?b.queryInstIdData(INSTRUMENT_STORE.remoteDB):(console.log(a),b.$router.push({path:"/instrumentos"}))})},fnConfigPeriodicidade=function(a,b,c){a=a[a.length-1];var d={};a?(d.periodicidade=a.periodicidade,d.periodicidadeAlerta=a.periodicidadeAlerta):d=b?{periodicidade:{val:{1:1/30,0:.25,3:1,2:12}[c]*b,suffixo:"months"}}:{periodicidade:{val:12,suffixo:"months"}};d.periodicidadeAlerta=d.periodicidadeAlerta||
{val:2,suffixo:"months"};return d},INSTRUMENT_STORE={state:{data:{},descItem:null,instrumentos:{},db:void 0,faixas:[],status:void 0,configPeriodicidade:void 0,funcoes:void 0,Analises:void 0,isLanding:null,online:navigator.onLine,usuarioTemAdminRole:null,landingScroll:null,modals:{confirmaGravaConfFormVisivel:!1,confirmarRemoverUsuario:!1,novoUsuarioDialog:!1,configDialog:!1,ocorrenciasActive:!1,solicitarActive:!1,gerenciandoUsuarios:!1,helpFaixa:!1,helpTendencia:!1,helpRegra:!1,helpFormulas:!1,helpDados:!1,
termosDeUso:!1}},update:function(a){this.state.data=a;var b=a.inst,c=fnConfigPeriodicidade(a.config.filter(function(a){return!!a.periodicidade}),b.AlPeriodoCalibracao,b.AlTipoPeriodo);this.state.configPeriodicidade=c;this.state.descItem=(("-"!==b.modelo&&b.modelo?""+b.modelo+", ":"")+("-"!==b.identificacao?"identifica\u00e7\u00e3o "+b.identificacao+", ":"")+("-"!==b.numeroserie?"s\u00e9rie n.: "+b.numeroserie+", ":"")+("-"!==b.patrimonio?"patrim\u00f4nio "+b.patrimonio:"")).trim().replace(/, (?![\s\S]*, )/,
" e ");this.state.faixas=[];a.seriesDenormRes&&(this.state.status=fnPegaStatus(a.seriesDenormRes[0].dataUltimaCal,c),a=a.seriesDenormRes.map(function(a){return{DescFaixa:a.DescFaixa,CodigoFaixaModelo:a.CodigoFaixaModelo}}),this.state.faixas=_.uniqBy(a,"CodigoFaixaModelo"))},updateInstrumentos:function(a){this.state.instrumentos=a}},Instrumentos={props:[],template:document.getElementById("__template_Instrumentos").innerHTML,data:function(){return{instrumentState:INSTRUMENT_STORE.state,termoBusca:"",
filtroSituacao:"TODOS"}},created:function(){},computed:{loadingInstrumentosFiltro:function(){return 0===this.instrumentos.length},instrumentos:function(){var a=this;return Object.keys(this.instrumentState.instrumentos).map(function(b){return a.instrumentState.instrumentos[b]})},instrumentosFiltro:function(){var a=this;var b="TODOS"===this.filtroSituacao?this.instrumentos:this.instrumentos.filter(function(b){return b.status.situacao===a.filtroSituacao});return this.termoBusca.length?(new Fuse(b,{shouldSort:!0,
threshold:.3,location:0,distance:500,maxPatternLength:32,minMatchCharLength:1,keys:["item.fabricante","item.modelo","item.identificacao","item.numeroserie","item.patrimonio"]})).search(this.termoBusca):b}}},Instrument=Vue.component("instrument",{template:'\n    <div>\n      <div v-if="!instrumentState.data.inst || !instrumentState.db">\n        <a class="button is-loading is-text is-large is-fullwidth">\n        </a>\n      </div>\n      <router-view v-if="instrumentState.data.inst && instrumentState.db"></router-view>\n    </div>',
data:function(){return{instrumentState:INSTRUMENT_STORE.state}},methods:{queryInstIdData:fnQueryInstIdData},mounted:function(){this.queryInstIdData()},computed:{}}),InstrumentAnalise=Vue.component("instrument-analise",{props:["store"],template:document.getElementById("__template_InstrumentAnalise").innerHTML,watch:{"winSize.w":function(){this.winSizeChangeHandler()},graficoVisivelMobile:function(a){var b=this;this.$nextTick(function(){"faixa"===a?b.chart.reflow():b.chartHist.reflow()})},histPontoSel:function(){},
histSerieSel:function(){},mudancaDeHist:function(){this.atualizarGraficoHistorico()},eventoSelecionado:function(){if("Agora"!==this.eventoSelecionado){var a=moment(this.eventoSelecionado).format("DD-MM-YYYY-HH-mm-ss");this.$router.push({query:Object.assign({},this.$route.query,{evento:a})})}else this.$router.push({query:{faixa:this.$route.query.faixa}});this.executaAnalise({analiseDoUsuario:!1})},faixas:function(){this.selecionaFaixaPadrao()},"instrumentState.data.analise":{handler:function(a,b){this.executaAnalise({analiseDoUsuario:!1})},
deep:!0},respFreq:function(){this.atualizarGrafico()},respFreqLogX:function(){this.atualizarGrafico()},analiseFaixa:{handler:function(a,b){this.executaAnalise({analiseDoUsuario:!0})},deep:!0},faixaSelecionada:function(){this.histSerieSel=this.seriesFaixa[0].nomeSerie;this.histPontoSel=this.seriesFaixa[0].data.Valor[0];this.$router.push({query:Object.assign({},this.$route.query,{faixa:this.faixaSelecionada})});this.executaAnalise({analiseDoUsuario:!1})},exibirLegendas:function(){this.chart.legend.update({enabled:this.exibirLegendas})}},
beforeRouteUpdate:function(a,b,c){var d=this;a.query.faixa&&(a.query.faixa!==b.query.faixa&&(this.faixaSelecionada=""+a.query.faixa,this.eventosDaFaixa.filter(function(a){return a.data===d.eventoSelecionado}).length||(this.eventoSelecionado="Agora")),c())},data:function(){return{instrumentState:this.store||INSTRUMENT_STORE.state,analiseFaixa:{},faixaSelecionada:null,chart:null,chartHist:null,exibirLegendas:!1,respFreq:!1,respFreqLogX:!1,seriesColors:highchartsColors,dadosFaixa:null,resultadoAnalises:null,
eventoSelecionado:null,histSerieSel:null,histPontoSel:null,toleranciaCalculada:null,valorDeTeste:null,graficoVisivelMobile:"faixa",winSize:WIN_SIZE,ehBulmaTablet:void 0,exibirFormulas:!1,analiseNotas:null,formatoFormula:"excel",nomeCelula:"A1",configUpdateTodasAsFaixas:!1,novaConfObservacao:""}},created:function(){},mounted:function(){this.eventoSelecionado="Agora";this.selecionaFaixaPadrao();this.criarGrafico();this.criarGraficoHist();this.winSizeChangeHandler()},methods:{gravaConfHandler:function(){var a=
this,b={analise:{}},c=Date.now(),d=_.cloneDeep(this.analiseFaixa);"tol"!==d.lhs&&(delete d.tolUnidade,delete d.tolVal,delete d.tolVal,delete d.tolValNaUnidade);this.configUpdateTodasAsFaixas?(b.analise.global=d,b.analise.global.timestamp=c):(b.analise[this.$route.query.faixa]=d,b.analise[this.$route.query.faixa].timestamp=c);b._id=""+this.instrumentState.data.inst._id+"_config_"+c;b.autor=this.instrumentState.userCtx.name;b.timestamp=c;b.observacao=this.novaConfObservacao.length?this.novaConfObservacao:
null;b.type="config_"+this.instrumentState.data.inst._id;console.log(b);this.instrumentState.db.put(b).then(function(b){a.instrumentState.modals.confirmaGravaConfFormVisivel=!1;a.novaConfObservacao="";a.$toasted.show("Configura\u00e7\u00e3o gravada com sucesso.",{icon:"fa-check-circle"})}).catch(function(b){a.$toasted.show("Erro ao gravar configura\u00e7\u00e3o.",{icon:"fa-exclamation-triangle"})}).finally(function(){})},formulaDropDown:function(a){a=a.target.closest(".dropdown");a.classList.add("is-active");
fnHideOnClickOutside(a)},pegaTextoRegressaoParaTipo:function(a,b){a=_.find(this.equacaoResultadoAnalises,{nomeSerie:b})[a].termosRegressao;if("al"===this.formatoFormula){var c=SI.parse("1"+this.prefixo).number;a=a.formula.replace(/\n/g,"").replace(/ /g,"").replace(/se/g,"if").replace(/x/g,"leitura");return a=a.replace(/[0-9]*\.?,?[0-9]+([eE][-+]?[0-9]+)?/g,function(a,b,f,g){return(parseFloat(a.replace(",","."))*c).toExponential(2)})}return"="+a.formula.replace(/x/g,this.nomeCelula.length?this.nomeCelula:
"A1")},winSizeChangeHandler:function(){this.ehBulmaTablet=768>=this.winSize.w?!0:!1},criarGraficoHist:function(){this.chartHist=Highcharts.chart(this.$refs["grafico-historico-container"],{exporting:{enabled:!1},chart:{zoomType:"xy"},credits:{enabled:!1},title:{text:"..."},subtitle:{text:" "},xAxis:{type:"datetime",title:{text:"Data"}},legend:{enabled:this.exibirLegendas||!1,itemMarginTop:3,itemMarginBottom:3,backgroundColor:"rgba(0, 0, 0, 0.2)",layout:"horizontal",floating:!1,align:"right",verticalAlign:"bottom",
x:0,y:0,shadow:!1,navigation:{activeColor:"#3E576F",animation:!0,arrowSize:12,inactiveColor:"#CCC",style:{fontWeight:"bold",color:"#333",fontSize:"12px"}}},tooltip:{enabled:!1}});this.chartHist.addSeries(this.serieHist);this.chartHist.addSeries(this.serieIncertezaHist);this.chartHist.addSeries(this.serieTolHist)},atualizarGraficoHistorico:function(){this.chartHist.title&&this.chartHist.title.update({text:this.tituloHist});this.chartHist.subtitle&&this.chartHist.subtitle.update({text:this.ultimoCertFxSel.certificado});
this.chartHist.yAxis[0].setTitle({text:"Erro "+this.prefixoUnidadeParenteses});this.chartHist.series[0].setData(this.serieHist.data,!1);this.chartHist.series[1].setData(this.serieIncertezaHist.data,!1);this.chartHist.series[2].setData(this.serieTolHist.data,!1);this.chartHist.xAxis[0].update({min:null,max:null});this.chartHist.redraw()},histSeriePontoSelHandler:function(){var a=this.$refs.histSeriePontoSel.selectedOptions[0];this.histSerieSel=a.parentElement.label;this.histPontoSel=a.value},histSerieProximoPontoSelHandler:function(){var a=
this.$refs.histSeriePontoSel;a.selectedIndex<a.length-1&&(a.selectedIndex+=1,this.histSeriePontoSelHandler())},histSeriePontoAnteriorSelHandler:function(){var a=this.$refs.histSeriePontoSel;0<a.selectedIndex&&(--a.selectedIndex,this.histSeriePontoSelHandler())},ajustarArea:function(a){1===a.data.length&&(a.data.push([a.data[0][0],a.data[0][1],a.data[0][2]]),a.data[0][0]*=.99,a.data[1][0]*=1.01)},criarGrafico:function(){this.chart=Highcharts.chart(this.$refs["grafico-faixa-container"],{exporting:{enabled:!1},
title:{text:this.titulo},subtitle:{text:" "},chart:{zoomType:"xy"},credits:{enabled:!1},legend:{enabled:this.exibirLegendas||!1,itemMarginTop:3,itemMarginBottom:3,backgroundColor:"rgba(0, 0, 0, 0.2)",layout:"horizontal",floating:!1,align:"right",verticalAlign:"bottom",x:0,y:0,shadow:!1,navigation:{activeColor:"#3E576F",animation:!0,arrowSize:12,inactiveColor:"#CCC",style:{fontWeight:"bold",color:"#333",fontSize:"12px"}}},tooltip:{enabled:!1}})},removerSeries:function(){for(var a=this.chart.series.length-
1;0<=a;a--)this.chart.series[a].remove(!1)},atualizarGrafico:function(){this.chart.title&&this.chart.title.update({text:this.titulo});this.chart.subtitle&&this.chart.subtitle.update({text:this.ultimoCertFxSel.certificado+" de "+this.dataFmt});this.chart.yAxis[0].setTitle({text:"Erro "+this.prefixoUnidadeParentesesY});this.chart.xAxis[0].setTitle({text:"Ponto "+this.prefixoUnidadeParentesesX});var a=this.flattenSeries;if(a.length!==this.chart.series.length){this.removerSeries();for(var b=0;b<a.length;b++)this.chart.addSeries(a[b],
!1)}else for(b=0;b<a.length;b++)a[b].name!==this.chart.series[b].name&&this.chart.series[b].update({name:a[b].name}),this.chart.series[b].setData(a[b].data,!1);this.chart.xAxis[0].update({min:null,max:null,type:this.respFreqLogX&&this.podeTerRespFreq&&this.respFreq?"logarithmic":null});this.chart.redraw()},executaAnalise:function(a){a.analiseDoUsuario?(a=new this.instrumentState.Analises(this.instrumentStateDataEventoSel,this.faixaSelecionada,this.analiseFaixa),a.executa(),this.dadosFaixa=a.dadosFaixa,
this.resultadoAnalises=a.resultadoAnalises,this.toleranciaCalculada=a.toleranciaCalculada,this.analiseNotas=a.analiseNotas,this.atualizarGrafico(),this.atualizarGraficoHistorico()):(a=new this.instrumentState.Analises(this.instrumentStateDataEventoSel,this.faixaSelecionada),this.analiseFaixa=_.clone(a.analiseFaixa))},selecionaFaixaPadrao:function(){if(this.instrumentState.faixas.length){var a=""+this.$route.query.faixa,b=this.instrumentState.faixas.filter(function(b){return b.CodigoFaixaModelo===
a}).length;this.faixaSelecionada=a&&b?a:this.instrumentState.faixas[0].CodigoFaixaModelo}}},computed:{ocultarConformidade:function(){return!1},textoAnalise:function(){return this.ehNovaExatidao?"Nova Incerteza":"EMA"},colunas:function(){var a=[{prop:"ValorDoInstrumento",label:"Ponto "+this.prefixoUnidadeParentesesX},{prop:"ResultadoMedicao",label:"Erro "+this.prefixoUnidadeParentesesY},{prop:"IncertExpandidaUsada",label:"U "+this.prefixoUnidadeParentesesY},{prop:"tol",label:this.textoAnalise+" "+
this.prefixoUnidadeParentesesY}];this.ocultarConformidade||(a=a.concat({prop:"pontoConforme",label:"Conformidade"}));1<this.nSeries&&(a=[{prop:"nomeSerie",label:"S\u00e9rie"}].concat(a));return a},dadosTabela:function(){var a=this.colunas.map(function(a){return a.prop});return this.resultadoAnalisesFlattenDeep.map(function(b){var c={};a.map(function(a){var d=b[a];_.isNumber(d)&&(c[a]=fnSignformatter(d));_.isArray(d)&&(c[a]=fnSignformatter(Math.abs(d[0])));_.isString(d)&&(c[a]=d);_.isBoolean(d)&&(c[a]=
d?!0:!1)});return c})},prefixoUnidadeRes:function(){return"al"===this.formatoFormula?this.dadosFaixa.Unidade:this.prefixoUnidade},textoValorCorrigido:function(){return this.analiseFaixa.aplicarCorrecao?"valor corrigido: ":""},textoInc:function(){var a=this;return this.resultadosPontoTeste.map(function(b){return a.pegaTextoRegressaoParaTipo("regInc",b[1])})},textoCorr:function(){var a=this;return this.resultadosPontoTeste.map(function(b){return a.pegaTextoRegressaoParaTipo("regCorr",b[1])})},tamCorr:function(){return this.ehNovaExatidao?
12:24},resultado2fmt:function(){var a=this;return this.resultadosPontoTeste.map(function(b){return a.ehNovaExatidao?"("+b[2].replace(/\./g,",")+")":b[2].split(" ")[0].replace(/\./g,",")})},ehNovaExatidao:function(){return"ema"!==this.analiseFaixa.lhs&&"tol"!==this.analiseFaixa.lhs},equacaoResultadoAnalises:function(){if(this.resultadoAnalises&&this.toleranciaCalculada){var a=this.toleranciaCalculada;return this.resultadoAnalises.map(function(b,c){var d={};d.CodigoFaixaModelo=b[0].CodigoFaixaModelo;
d.nomeSerie=b[0].nomeSerie;var e=b.map(function(b,d){return[b.ValorDoInstrumento,a[c][d][1]]});e=regressao(e);b=b.map(function(a){return[a.ValorDoInstrumento,-a.ResultadoMedicao]});b=regressao(b);return _.extend(d,{regInc:e,regCorr:b})})}},resultadosPontoTeste:function(){var a=this;if(this.equacaoResultadoAnalises){var b=[];this.equacaoResultadoAnalises.map(function(c,d){var e=parseFloat(a.valorDeTeste),f=c.regCorr.equacaoArr;var g=fnRegreArray(c.regInc.equacaoArr,e);f=fnRegreArray(f,e);g=g[0]*e+
g[1];e="number"!==typeof e||isNaN(e)?0:a.analiseFaixa.aplicarCorrecao?(e+f[0]*e+f[1]).toString():a.valorDeTeste;Infinity!==g?(g=0>=g?"0":fnSignformatter(g),f=g.split("."),f=2===f.length?f[1].length:0,b.push([a.seriesColors[d],c.nomeSerie,parseFloat(e).toFixed(f)+" \u00b1 "+g])):b.push([a.seriesColors[d],c.nomeSerie,"Infinito"])});return b}},pontosDaSerieSelecionada:function(){return this.pontosExistenteParaCadaSerie[this.histSerieSel]},ehPrimeiroPontoDoHistorico:function(){return this.nomesDasSeries[0]===
this.histSerieSel&&parseFloat(this.histPontoSel)===this.pontosDaSerieSelecionada[0]},ehUltimoPontoDoHistorico:function(){return this.nomesDasSeries[this.nomesDasSeries.length-1]===this.histSerieSel&&parseFloat(this.histPontoSel)===this.pontosDaSerieSelecionada[this.pontosDaSerieSelecionada.length-1]},mudancaDeHist:function(){return""+this.histSerieSel+"___"+this.histPontoSel+"___"+this.faixaSelecionada},seriesFaixaAgrupadas:function(){return _.groupBy(this.seriesFaixa,"nomeSerie")},nSeries:function(){return this.nomesDasSeries.length},
nomesDasSeries:function(){return Object.keys(this.seriesFaixaAgrupadas)},pontosExistenteParaCadaSerie:function(){var a=this,b={};this.nomesDasSeries.map(function(c){var d=[];a.seriesFaixaAgrupadas[c].map(function(a){d=d.concat(a.data.Valor)});b[c]=_.uniq(d)});return b},histSerieSelList:function(){if(this.seriesFaixaAgrupadas&&this.histSerieSel&&this.seriesFaixaAgrupadas[this.histSerieSel]){var a=this.seriesFaixaAgrupadas[this.histSerieSel].map(function(a){return a.historicosPontos});return _.flattenDeep(a)}},
histPontoSelList:function(){var a=this;if(this.histSerieSelList){var b=this.histSerieSelList.filter(function(b){return b.serie.Valor===parseFloat(a.histPontoSel)});return _.uniqBy(b,"HoraInicial")}},serieHist:function(){var a={name:"Tend\u00eancia",id:"Historico",yAxis:0,type:"line"};a.data=this.historicoDoPontoNaoNulo.map(function(a){return[fnPegaDataUTCNum(a.HoraInicial),a.serie.ResultadoMedicao]});return a},serieIncertezaHist:function(){var a={whiskerLength:10,name:"Incerteza",yAxis:0,type:"errorbar"};
a.data=this.historicoDoPontoNaoNulo.map(function(a){var b=a.serie.IncertExpandidaUsada,d=a.serie.ResultadoMedicao;if(null!==d){var e=d-b;b=d+b}else b=e=null;return[fnPegaDataUTCNum(a.HoraInicial),e,b]});return a},resultadoAnalisesFlattenDeep:function(){return _.flattenDeep(this.resultadoAnalises)},resPontoSel:function(){var a=this;return this.resultadoAnalisesFlattenDeep.filter(function(b){return b.Valor===parseFloat(a.histPontoSel)&&b.nomeSerie===a.histSerieSel})[0]},serieTolHist:function(){var a=
this;if(this.resPontoSel){var b=this.resPontoSel.tol;var c=b[0];var d=b[1]}b={whiskerLength:10,name:"EMA",yAxis:0,type:"arearange",marker:{enabled:!1},fillOpacity:0,dashStyle:"Dash",lineColor:"red",color:"#ff0000"};b.data=this.historicoDoPontoNaoNulo.map(function(b){a.resPontoSel||(c=b.serie.ErroMinimoFaixa,d=b.serie.ErroMaximoFaixa);if(null!==c&&0!==c){var e=c;var g=d}else g=e=null;return[fnPegaDataUTCNum(b.HoraInicial),e,g]});this.ajustarArea(b);return b},tituloHist:function(){if(!this.pontoSel)return"";
var a=this.pontoSel.nomeSerie;return(""+this.pontoSel.val).toString()+" "+this.prefixoUnidade+("S\u00e9rie"!==a||""!==a?" ("+this.pontoSel.nomeSerie+")":"")},historicoDoPontoNaoNulo:function(){return _.chain(this.histPontoSelList).filter(function(a){return null!==a.serie.ResultadoMedicao}).sortBy(function(a){return fnPegaDataUTCNum(a.HoraInicial)}).value()},instrumentStateDataEventoSel:function(){var a=this;if(!this.$route.query.evento)return this.instrumentState.data;var b={};Object.keys(this.instrumentState.data).map(function(c){b[c]=
"seriesDenormRes"===c?a.seriesFaixaEvento:"config"===c?a.configDaFaixaListEvento:a.instrumentState.data[c]});return b},eventoTimeStamp:function(){return this.$route.query.evento?1E3*moment(this.$route.query.evento,"DD-MM-YYYY-HH-mm-ss").unix()+1E3:Infinity},configDaFaixaList:function(){var a=this;return this.instrumentState.data.config.filter(function(b){return b.analise&&(b.analise[a.faixaSelecionada]||b.analise.global)})},configDaFaixaListEvento:function(){var a=this;return this.configDaFaixaList.filter(function(b){return b.timestamp<=
a.eventoTimeStamp})},eventosDaFaixa:function(){var a=[],b={};this.seriesFaixa.map(function(c){b[c.Certificado]||(a.push({tipo:"calibra\u00e7\u00e3o",data:1E3*moment(c.HoraInicial).unix(),dataHuman:moment(c.HoraInicial).format("DD/MM/YYYY")}),b[c.Certificado]=!0)});this.configDaFaixaList.map(function(b){a.push({tipo:"an\u00e1lise",data:b.timestamp,dataHuman:moment(b.timestamp).format("DD/MM/YYYY")})});return _.reverse(_.sortBy(a,"data"))},dataFmt:function(){var a=this.ultimoCertFxSel.hora;return a?
moment(a).format("DD/MM/YY"):""},ultimoCertFxSel:function(){return this.seriesFaixaEvento.length?{certificado:this.seriesFaixaEvento[0].Certificado,hora:this.seriesFaixaEvento[0].HoraInicial}:{certificado:null,hora:null}},prefixoUnidade:function(){if(!this.seriesFaixaEvento.length)return"";var a=this.seriesFaixaEvento[0];return a.Prefixo+a.Unidade},prefixoUnidadeParenteses:function(){return""!==this.prefixoUnidade?"("+this.prefixoUnidade+")":""},prefixoUnidadeParentesesX:function(){return this.respFreq?
"(Hz)":this.prefixoUnidadeParenteses},prefixoUnidadeParentesesY:function(){return this.prefixoUnidadeParenteses},analisesDisponiveis:function(){var a=this;return Object.keys(this.instrumentState.funcoes).map(function(b){return{desc:a.instrumentState.funcoes[b].desc,nome:b}})},titulo:function(){if(!this.faixaSelecionada)return null;if(this.seriesFaixaEvento.length)return this.seriesFaixaEvento[0].DescFaixa},podeTerRespFreq:function(){return this.seriesFaixaEvento.map(function(a){return SI.parse(a.nomeSerie)}).reduce(function(a,
b){return 0<=b.number&&"Hz"===_.trim(b.unit)&&a},!0)},seriesGrafico:function(){var a=this;return this.dadosFaixaFmt.series.map(function(b,c){var d={};d.name=b.nome;d.id=b.nome;d.data=[];for(var e=0;e<b.data.ResultadoMedicao.length;e++){var f=a.analiseFaixa.aplicarCorrecao?0:b.data.ResultadoMedicao[e];d.data.push([b.data.ValorDoInstrumento[e],f])}d.yAxis=0;d.type="line";d.color=a.seriesColors[c];return d})},seriesIncerteza:function(){var a=this;return this.dadosFaixaFmt.series.map(function(b){var c=
Object({});c.name=b.nome+" (Incerteza)";c.data=[];for(var d=0;d<b.data.ResultadoMedicao.length;d++){var e=a.analiseFaixa.aplicarCorrecao?0:b.data.ResultadoMedicao[d];c.data.push([b.data.ValorDoInstrumento[d],e-b.data.IncertExpandidaUsada[d],e+b.data.IncertExpandidaUsada[d]])}c.type="errorbar";c.whiskerLength=10;return c})},seriesTol:function(){var a=this;if(!this.resSeriesFaixaSelFmt.length)return null;var b=this.dadosFaixaFmt.series.map(function(b,c){var d=Object({});d.dashStyle="Dash";d.lineColor=
"red";d.name=b.nome+" (EMA)";d.id=d.name;d.data=a.resSeriesFaixaSelFmt[c].map(function(a){return[a.ValorDoInstrumento].concat(a.tol)});d.marker={enabled:!1};a.ajustarArea(d);d.color="#ff0000";d.type="arearange";d.fillOpacity=0;return d});if("criterioAceitacao"===this.analiseAtiva&&"ema"!==this.analiseFaixa.lhs){var c=_.clone(b[0]);c.data=_.chain(b).map(function(a){return a.data}).flatten().sortBy(function(a){return a[0]}).value();c.id=c.name;return[c]}return b},seriesResultadoAnalises:function(){var a=
this;return this.dadosFaixaFmt.series.map(function(b,c){var d={};d.name=b.nome+" (An\u00e1lise)";d.linkedTo=b.nome;d.data=[];for(var e=0;e<b.data.ResultadoMedicao.length;e++)d.data.push([b.data.ValorDoInstrumento[e],a.resSeriesFaixaSelFmt[c][e].analise[0],a.resSeriesFaixaSelFmt[c][e].analise[1]]);a.ajustarArea(d);d.marker={enabled:!1};d.type="arearange";d.dashStyle="Dot";d.color=a.seriesColors[c];d.fillOpacity=.15;return d})},flattenSeries:function(){return _.chain([this.seriesGrafico,this.seriesResultadoAnalises,
this.seriesTol,this.seriesIncerteza]).flatten().compact().filter(function(a){a=a.data.map(function(a){return null===a[1]});return!_.filter(a,function(a){return a}).length}).sortBy(function(a){return a.name}).value()},faixas:function(){return this.instrumentState.faixas.length?this.instrumentState.faixas:null},dadosFaixaFmt:function(){var a=this;if(this.respFreq&&this.podeTerRespFreq){for(var b=[],c={},d=0;d<this.dadosFaixa.series.length;c={$jscomp$loop$prop$serie$4:c.$jscomp$loop$prop$serie$4},d++){c.$jscomp$loop$prop$serie$4=
this.dadosFaixa.series[d];for(var e={},f=0;f<c.$jscomp$loop$prop$serie$4.data.Valor.length;e={$jscomp$loop$prop$obj$2:e.$jscomp$loop$prop$obj$2},f++)e.$jscomp$loop$prop$obj$2=Object.create({}),_.keys(c.$jscomp$loop$prop$serie$4.data).map(function(a,b){return function(c){a.$jscomp$loop$prop$obj$2[c]=b.$jscomp$loop$prop$serie$4.data[c][f]}}(e,c)),e.$jscomp$loop$prop$obj$2.nome=c.$jscomp$loop$prop$serie$4.nome,e.$jscomp$loop$prop$obj$2.cod=c.$jscomp$loop$prop$serie$4.cod,e.$jscomp$loop$prop$obj$2.sortval=
c.$jscomp$loop$prop$serie$4.sortval,b.push(e.$jscomp$loop$prop$obj$2)}var g=_.groupBy(b,"Valor");return{series:_.keys(g).map(function(b){var c=g[b],d={cod:"respFreq_"+b,nome:b+" "+a.prefixoUnidade,sortval:null,data:{}};"ErroMaximoFaixa ErroMinimoFaixa IncertExpandidaUsada ResultadoMedicao Valor ValorDoInstrumento ValorDoPadrao fatork".split(" ").map(function(a){d.data[a]=[];for(var b=0;b<c.length;b++)"ValorDoInstrumento"===a?d.data[a].push(SI.parse(c[b].nome).number):d.data[a].push(c[b][a])});return d})}}return this.dadosFaixa},
resSeriesFaixaSelFmt:function(){if(this.respFreq&&this.podeTerRespFreq){var a=_.cloneDeep(this.resultadoAnalises);a=_.flatten(a).map(function(a){a.ValorDoInstrumento=SI.parse(a.nomeSerie).number;a.cod="respFreq_"+a.Valor;return a});var b=_.groupBy(a,"cod");return this.dadosFaixaFmt.series.map(function(a){return b[a.cod]})}return this.resultadoAnalises},series:function(){return this.instrumentState.data.seriesDenormRes},seriesFaixa:function(){var a=this;return this.series.filter(function(b){return b.CodigoFaixaModelo===
a.faixaSelecionada})},seriesFaixaEvento:function(){var a=this;return this.seriesFaixa.filter(function(b){return 1E3*moment(b.HoraInicial).unix()<=a.eventoTimeStamp})},analiseAtiva:function(){return this.instrumentState.funcoes[this.analiseFaixa.lhs].tipoAnalise}}}),$jscomp$compprop0={},InstrumentCertificado={props:[],template:document.getElementById("__template_InstrumentCertificado").innerHTML,watch:($jscomp$compprop0["instrumentState.online"]=function(a){a&&(this.erro=null,this.pegaLista(),this.embedPdf())},
$jscomp$compprop0.src=function(){this.embedPdf()},$jscomp$compprop0),created:function(){this.pegaLista()},data:function(){return{instrumentState:INSTRUMENT_STORE.state,erro:!1,pdfObjList:null,pdfList:null,src:null,loading:!1,remoteDB:INSTRUMENT_STORE.remoteDB}},mounted:function(){document.getElementById("pdf-container").style.display="none";this.embedPdf()},methods:{pegaLista:function(){var a=this,b=INSTRUMENT_STORE.remoteDB;b&&b.get(this.$route.params.id+"_anexos").then(function(b){var c=b._attachments,
e=localStorage.getItem("nomedb");a.pdfObjList=_.chain(c).keys().filter(function(a){return"application/pdf"===c[a].content_type}).map(function(b){return{path:"https://procal.ipt.br:15984/"+e+"/"+a.$route.params.id+"_anexos/"+b,name:b}}).sortBy(function(a){return parseInt(a.name.split("-")[0])}).reverse().value();a.pdfList=a.pdfObjList.map(function(a){return a.path});a.src||(a.src=a.pdfList[0]||null)}).catch(function(b){a.erro=b.error;"unknown"!==b.name&&(a.pdfList=[])})},setLoggedOut:function(){this.$parent.$parent.setLoggedOut()},
embedPdf:function(){var a=this,b={pdfOpenParams:{scrollbar:"0",toolbar:"0",statusbar:"0",messages:"0",navpanes:"0"},id:"pdfjs-iframe-id",PDFJS_URL:"https://pdf.procal.ipt.br/pdfjs/web/viewer.html"};this.src&&(this.loading=!0,INSTRUMENT_STORE.remoteDB.get(this.$route.params.id+"_anexos").then(function(c){PDFObject.embed(a.src,"#pdf-container",b);document.getElementById("pdf-container").style.display="";fnHandleResize();-1<navigator.userAgent.toLowerCase().indexOf("firefox")?(c=document.getElementById("pdfjs-iframe-id"),
console.log(c.contentWindow.location.href,c.src),c.src=a.src,c.onload=function(){a.loading=!1}):window.setTimeout(function(){a.loading=!1},4E3)}).catch(function(){a.loading=!1}))}},computed:{}},Login=Vue.component("login",{template:document.getElementById("__template_Login").innerHTML,data:function(){var a=this.$route.query.token;return{loginDB:new PouchDB(window.DB_ADDR+"_users",{skip_setup:!0,ajax:{timeout:5E3}}),action:a?"definir":"login",token:a,username:"",password:"",passwordComfirm:"",processando:null,
instrumentState:INSTRUMENT_STORE.state}},methods:{submitSolicitar:function(){var a=this;this.processando=!0;axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/request_password_reset",withCredentials:!0,data:{user_name:this.username}}).then(function(b){a.$toasted.show("Um e-mail foi enviado solicitando a redefini\u00e7\u00e3o da senha.",{icon:"done"})}).catch(function(b){a.$toasted.show("N\u00e3o foi poss\u00edvel solicitar a troca de senha.",{icon:"error"})}).finally(function(){a.processando=
!1;a.action="login"})},redirectLogin:function(){window.location.replace(document.location.origin+document.location.pathname+"?/#/?action=login")},submitDefinir:function(){var a=this;this.processando=!0;("MOCK_TOKEN"===this.$route.query.token?new Promise(function(a,c){return a("ok")}):axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/reset_password",withCredentials:!0,data:{token:this.$route.query.token,new_password:this.password}})).then(function(b){if(a.$route.query.name)return a.username=
a.$route.query.name,b;a.$toasted.show("Senha definida. Redirecionando para tela de login...",{icon:"done"});window.setTimeout(function(){a.redirectLogin()},2400)}).then(function(b){b&&(a.$toasted.show("Senha definida.",{icon:"done"}),a.submitLogin())}).catch(function(b){a.$toasted.show("N\u00e3o foi poss\u00edvel definir a senha",{icon:"error"})}).finally(function(){a.processando=!1})},submitLogin:function(){var a=this;localStorage.setItem("ms_username",this.username);this.processando=!0;this.loginDB.login(this.username,
this.password).then(function(b){b&&b.ok&&a.$emit("check_login")}).catch(function(b){console.log(b);"unauthorized"===b.name?a.$toasted.show("Usu\u00e1rio ou senha inv\u00e1lido",{icon:"exclamation-circle"}):a.$toasted.show("N\u00e3o foi poss\u00edvel entrar agora. Tente em breve.",{icon:"exclamation-circle"})}).finally(function(){a.processando=!1})}},computed:{scorePassword:function(){var a=0;if(!this.password)return a;for(var b={},c=0;c<this.password.length;c++)b[this.password[c]]=(b[this.password[c]]||
0)+1,a+=5/b[this.password[c]];b={digits:/\d/.test(this.password),lower:/[a-z]/.test(this.password),upper:/[A-Z]/.test(this.password),nonWords:/\W/.test(this.password)};c=0;for(var d in b)c+=1==b[d]?1:0;return parseInt(a+10*(c-1))},solicitarValid:function(){return""!==this.username},loginValid:function(){return this.solicitarValid&&""!==this.password},definirValid:function(){return""!==this.password&&this.password===this.passwordComfirm&&6<=this.password.length}}}),Landing=Vue.component("landing",
{template:document.getElementById("__template_Landing").innerHTML,watch:{"instrumentState.landingScroll":function(a){if(a=this.$refs[a]){var b=a.getBoundingClientRect();window.scrollTo({top:b.top+a.ownerDocument.defaultView.pageYOffset,left:0,behavior:"smooth"});this.instrumentState.landingScroll=null}}},data:function(){return{instrumentState:INSTRUMENT_STORE.state}},methods:{},mounted:function(){},computed:{}}),AppNav=Vue.component("app-nav",{props:[],template:document.getElementById("__template_AppNav").innerHTML,
watch:{"instrumentState.configPeriodicidade":{handler:function(){this.periodicidade.val=this.instrumentState.configPeriodicidade.periodicidade.val;this.periodicidade.status=this.instrumentState.configPeriodicidade.periodicidade.status||"Ativo"},deep:!0}},data:function(){return{instrumentState:INSTRUMENT_STORE.state,burgerActive:!1,enviandoMsg:!1,usersForm:{username:"",password:""},gerenciandoUsuariosLogged:!1,processandoAcaoUsuarios:!1,usuarioPodeGerirUsuarios:!1,userList:[],novoUsername:"",periodicidade:{val:null,
status:"Ativo"},ocorrenciaDesc:"",categoriasSelecionadas:[],gravandoOcorrencia:!1,novaOcorrenciaFormVisivel:!1}},mounted:function(){},methods:{novaOcorrencia:function(){var a=this;this.gravandoOcorrencia=!0;var b=Date.now();this.instrumentState.db.put({_id:""+this.instrumentState.data.inst._id+"_ocorr_"+b,autor:this.instrumentState.userCtx.name,timestamp:b,desc:this.ocorrenciaDesc,categorias:this.categoriasSelecionadas,type:"ocorr_"+this.instrumentState.data.inst._id}).then(function(b){a.$toasted.show("Ocorr\u00eancia registrada.",
{icon:"fa-check-circle"});a.ocorrenciaDesc="";a.categoriasSelecionadas=[];a.novaOcorrenciaFormVisivel=!1}).catch(function(b){a.$toasted.show("N\u00e3o foi poss\u00edvel registrar a ocorrencia.",{icon:"fa-exclamation-triangle"})}).finally(function(){a.gravandoOcorrencia=!1})},msgboxEnviaEmail:function(){var a=this;this.enviandoMsg=!0;var b="<p>"+this.$refs.solicMsg.value+"\n</p><p>email: "+localStorage.getItem("ms_username")+"</p><p>nome: "+(localStorage.getItem("displayName")||"sem nome informado")+
"</p><p>empresa: "+(this.instrumentState.data.inst.empresa||"sem nome definido")+"</p>";axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/call_after_challenge",timeout:5E3,data:{data:b,doc_id:this.instrumentState.data.inst._id,rev:this.instrumentState.data.inst._rev,db_name:window.localStorage.getItem("nomedb")}}).then(function(b){a.$toasted.show("Mensagem enviada.",{icon:"fa-check-circle"})}).catch(function(b){console.log(b);a.$toasted.show("Erro ao enviar mensagem.",{icon:"fa-exclamation-triangle"})}).finally(function(){a.enviandoMsg=
!1})},pegaSessaoGestaoUsuarios:function(){var a=this;axios({method:"get",url:"https://procal.ipt.br/couch_user_manager/session",withCredentials:!0}).then(function(b){if(a.usuarioPodeGerirUsuarios=b.data)a.pegaListaUsuarios(),a.gerenciandoUsuariosLogged=!0}).catch(function(a){console.log(a)})},iniciaGestaoUsuarios:function(){var a=this;this.processandoAcaoUsuarios=!0;axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/session",timeout:5E3,withCredentials:!0,data:{username:this.usersForm.username,
password:this.usersForm.password,db_name:window.localStorage.getItem("nomedb")}}).then(function(b){a.pegaSessaoGestaoUsuarios();a.pegaListaUsuarios()}).catch(function(b){"ECONNABORTED"===b.code?a.$toasted.show("N\u00e3o foi poss\u00edvel iniciar a gest\u00e3o de usu\u00e1rios agora. Tente novamente em breve.",{icon:"fa-exclamation-triangle"}):a.$toasted.show("Usu\u00e1rio ou senha inv\u00e1lido",{icon:"fa-exclamation-triangle"});a.processandoAcaoUsuarios=!1;a.pegaSessaoGestaoUsuarios()})},pegaListaUsuarios:function(){var a=
this;axios({method:"get",url:"https://procal.ipt.br/couch_user_manager/list_users",withCredentials:!0,params:{db_name:window.localStorage.getItem("nomedb")}}).then(function(b){a.userList=b.data.map(function(a){var b={};b.name=a.name;b.admin=-1!==a.roles.indexOf(window.localStorage.getItem("nomedb")+"__admin");return b}).filter(function(a){return a.name!==window.localStorage.getItem("nomedb")+"-admin"});a.processandoAcaoUsuarios=!1}).catch(function(b){console.log(b);a.processandoAcaoUsuarios=!1;a.usuarioPodeGerirUsuarios=
!1;a.apagaSessao()})},removeUsuario:function(a){var b=this;this.instrumentState.modals.confirmarRemoverUsuario=!0;(new Promise(function(a,d){var c=b.$refs.removeUsuarioOk,f=b.$refs.removeUsuarioCancel;["click","ontouchstart"].map(function(b){c.addEventListener(b,function(){a("ok")});f.addEventListener(b,function(){d("ko")})})})).then(function(){b.processandoAcaoUsuarios=!0;axios({method:"delete",url:"https://procal.ipt.br/couch_user_manager/remove_user",withCredentials:!0,timeout:5E3,data:{db_name:window.localStorage.getItem("nomedb"),
user_name:a.target.getAttribute("user")}}).then(function(a){b.$toasted.show("Usu\u00e1rio removido",{icon:"fa-check-circle"});b.pegaListaUsuarios()}).catch(function(a){b.$toasted.show("error",{icon:"fa-exclamation-triangle"});b.processandoAcaoUsuarios=!1;b.pegaSessaoGestaoUsuarios()})}).catch(function(a){console.log(a)}).finally(function(){b.instrumentState.modals.confirmarRemoverUsuario=!1})},novoUsuario:function(){var a=this;this.processandoAcaoUsuarios=!0;axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/create_user",
withCredentials:!0,data:{db_name:window.localStorage.getItem("nomedb"),new_user_name:this.novoUsername,roles:[window.localStorage.getItem("nomedb")+"__member"].toString()}}).then(function(b){a.$toasted.show("Usu\u00e1rio "+a.novoUsername+" criado. Aguardando confirma\u00e7\u00e3o.",{icon:"fa-check-circle"});a.pegaListaUsuarios()}).catch(function(b){a.$toasted.show("Erro ao criar novo usu\u00e1rio.",{icon:"fa-exclamation-triangle"});console.log(b);a.processandoAcaoUsuarios=!1;a.pegaSessaoGestaoUsuarios()}).finally(function(){a.instrumentState.modals.novoUsuarioDialog=
!1;a.novoUsername=""})},mudaRole:function(a){var b=this;this.processandoAcaoUsuarios=!0;a=a.target.parentElement.getElementsByTagName("input")[0];var c=a.getAttribute("user");a=!a.checked;var d=this.userList.filter(function(a){return a.name===c});d[0].admin=!d[0].admin;axios({method:"post",url:"https://procal.ipt.br/couch_user_manager/update_roles",withCredentials:!0,timeout:5E3,data:{db_name:window.localStorage.getItem("nomedb"),user_name_to_manage:c,roles:window.localStorage.getItem("nomedb")+(a?
"__admin":"__member")}}).then(function(a){b.$toasted.show("Permiss\u00e3o alterada.",{icon:"fa-check-circle"})}).catch(function(a){b.$toasted.show("Erro ao alterar usu\u00e1rio.",{icon:"fa-exclamation-triangle"});console.log(a);b.pegaSessaoGestaoUsuarios()}).finally(function(){b.$nextTick(function(){b.pegaListaUsuarios()})})},novaConfig:function(a,b){var c=this,d=Date.now();a=_.cloneDeep(a);a._id=""+this.instrumentState.data.inst._id+"_config_"+d;a.autor=this.instrumentState.userCtx.name;a.timestamp=
d;a.type="config_"+this.instrumentState.data.inst._id;this.instrumentState.db.put(a).then(b).catch(function(a){c.$toasted.show("Erro ao gravar.",{icon:"fa-exclamation-triangle"});console.log(a)}).finally(function(){})},handleConfirmConfig:function(){var a=this,b={};b.periodicidade={val:parseInt(this.periodicidade.val),suffixo:"months",status:this.periodicidade.status};this.novaConfig(b,function(){a.$toasted.show("Periodicidade alterada.",{icon:"fa-check-circle"})});this.instrumentState.modals.configDialog=
!1},setLoggedOut:function(){window.localStorage.removeItem("nomedb");window.localStorage.removeItem("userCtx");document.getElementById("pdf-container").style.display="none";INSTRUMENT_STORE.state.db=null;INSTRUMENT_STORE.remoteDB&&INSTRUMENT_STORE.remoteDB.logOut(function(a,b){a&&console.log(a)})}},computed:{agora:function(){return moment().format("MMM YYYY")},confLog:function(){var a=this;if(!this.instrumentState.data.ocorr||!this.instrumentState.data.config||!this.instrumentState.funcoes)return[];
Object.keys(this.instrumentState.funcoes).map(function(b){window.T[b]=a.instrumentState.funcoes[b].desc});var b=[],c=null,d=this.instrumentState.data.config;this.instrumentState.faixas.concat([{CodigoFaixaModelo:"global",DescFaixa:"An\u00e1lise Global"}]).map(function(a){c=null;var e=a.CodigoFaixaModelo;d.filter(function(a){return a.analise&&a.analise[e]}).map(function(d){var f=moment(d.timestamp),g={alteracoes:[],icon:"sliders-h",obs:d.observacao,definicoes:[],categorias:[],autor:d.autor,data:d.timestamp,
titulo:a.DescFaixa,ano:f.year(),dataFmt:f.format("DD/MM/YYYY")},h=d.analise[e];Object.keys(h).filter(function(a){return-1===["timestamp"].indexOf(a)}).map(function(a){!c||c[a]===h[a]||_.isNil(c[a])||_.isNil(h[a])?(!c&&!_.isNil(h[a])||c&&_.isNil(c[a])&&!_.isNil(h[a])&&_.isNil(window.T[h[a]]))&&g.definicoes.push([window.T[a]||a," foi definido para ",window.T[h[a]]||h[a]]):g.alteracoes.push([window.T[a]," mudou de ",window.T[c[a]]||c[a]," para ",window.T[h[a]]||h[a]])});b.push(g);c=h})});c=null;d.filter(function(a){return a.periodicidade}).map(function(a){var d=
moment(a.timestamp);d={alteracoes:[],icon:"calendar-day",obs:null,definicoes:[],categorias:[],autor:a.autor,data:a.timestamp,titulo:null,ano:d.year(),dataFmt:d.format("DD/MM/YYYY")};c&&c.periodicidade.val!==a.periodicidade.val&&d.alteracoes.push(["Periodicidade","mudou de ",(c?c.periodicidade.val:"12")+" meses"," para ",a.periodicidade.val+" meses"]);c&&c.periodicidade.status!==a.periodicidade.status&&d.alteracoes.push(["Status","mudou de ",""+(c.periodicidade.status||"Ativo")," para ",a.periodicidade.status]);
b.push(d);c=a});this.instrumentState.data.ocorr.map(function(a){var c=moment(a.timestamp);a={alteracoes:[],icon:"edit",obs:a.desc,definicoes:[],categorias:a.categorias,autor:a.autor,data:a.timestamp,titulo:null,ano:c.year(),dataFmt:c.format("DD/MM/YYYY")};b.push(a)});for(var e={},f=this.instrumentState.data.seriesDenormRes.length-1;0<=f;f--){var g=this.instrumentState.data.seriesDenormRes[f];if(!e[g.Certificado]){var k=moment(g.HoraInicial);k={alteracoes:[],icon:"check",obs:"Calibra\u00e7\u00e3o executada. Certificado "+
g.Certificado,definicoes:[],categorias:[],autor:null,data:1E3*k.unix(),titulo:null,ano:k.year(),dataFmt:k.format("DD/MM/YYYY")};b.push(k);e[g.Certificado]=!0}}g=moment(this.instrumentState.data.seriesDenormRes[this.instrumentState.data.seriesDenormRes.length-1].HoraInicial);e=moment();f=[];for(g=g.year();g<=e.year();g++)f.push({type:"marcadorDeAno",ano:g,data:1E3*moment(""+g+"-01-01T00:00:00-06:00").unix()});f.filter(function(a){return!!b.filter(function(b){return a.ano===b.ano}).length}).map(function(a){b.push(a)});
return _.reverse(_.sortBy(b,"data"))},instId:function(){return this.$route.params.id},emInstrumento:function(){return"instrumento"===this.$route.path.split("/")[1]},rotaInst:function(){return this.$route.path.split("/")[3]},alertaInstrumento:function(){if(this.instId)return this.instrumentState.instrumentos[""+this.instId]},instrumentoStatus:function(){if(this.alertaInstrumento)return this.alertaInstrumento.status},ultimoCertificado:function(){var a=this;if(!this.instrumentState.data.seriesDenormRes||
!this.instrumentState.data.seriesDenormRes.length)return"-";var b=this.instrumentState.data.seriesDenormRes.filter(function(b){return b.HoraInicial===a.alertaInstrumento.status.dataUltimaCal})[0];return b?b.Certificado:"-"}}}),routes=[{path:"/instrumento/:id",component:Instrument,name:"instrumento",children:[{path:"analise",component:InstrumentAnalise,children:[{path:":CodigoFaixaModelo",props:!0}],props:!0},{path:"certificado",component:InstrumentCertificado,props:!0},{path:"",component:InstrumentCertificado,
props:!0}]},{path:"/instrumentos",component:Instrumentos,name:"instrumentos"},{path:"/landing",component:Landing,name:"landing"}],router=new VueRouter({routes:routes,linkActiveClass:"is-active"});window.DB_ADDR="https://procal.ipt.br:15984/";
window.T={global:"An\u00e1lise Global",fatorMultiplicativo:"Fator",aplicarCorrecao:"Corrigir",lhs:"EMA",calculoEscolha:"C\u00e1lculo",periodicidade:"Periodicidade",tolVal:"Valor da Toler\u00e2ncia relativa",tolUnidade:"Unidade da Toler\u00e2ncia relativa",tolValNaUnidade:"Valor da Toler\u00e2ncia na Unidade","true":"Verdadeiro","false":"Falso",tol:"Toler\u00e2ncia",ema:"Certificado de Calibra\u00e7\u00e3o"};Vue.use(Toasted,{theme:"toasted-primary",position:"top-center",duration:2E3,iconPack:"fontawesome"});
moment.locale("pt-br");window.addEventListener("online",function(){INSTRUMENT_STORE.state.online=!0;console.log("online")});window.addEventListener("offline",function(){INSTRUMENT_STORE.state.online=!1});router.beforeEach(function(a,b,c){b.params.id||(INSTRUMENT_STORE.state.data.inst=null);b=document.getElementById("pdf-container");-1!==a.path.indexOf("/certificado")&&INSTRUMENT_STORE.state.db||(b.style.display="none");"/instrumentos"===a.path&&(document.title="ProCal");c()});
var WIN_SIZE={w:null},fnHandleResize=function(){var a=document.getElementById("pdf-container");"none"!==a.style.display&&a.setAttribute("style","height:"+(window.innerHeight-a.offsetTop-16)+"px");window.WIN_SIZE.w=window.innerWidth};window.addEventListener("resize",fnHandleResize);fnHandleResize();
var app=(new Vue({router:router,watch:{"instrumentState.descItem":function(){document.title="ProCal - "+this.instrumentState.descItem},"$route.query.modal":function(a){var b=this;a||(Object.keys(this.instrumentState.modals).map(function(a){b.instrumentState.modals[a]=!1}),Object.assign(document.body.style,{marginRight:"0px"}))},"instrumentState.modals":{handler:function(a){a=_.clone(this.$route.query);var b=0;if(window.getComputedStyle){var c=window.getComputedStyle(document.body);c&&(b=parseInt(c.marginRight,
10))}Object.assign(document.body.style,{overflow:"hidden",marginRight:b+(window.innerWidth-document.body.clientWidth)+"px"});this.temModalAberto?(document.body.parentElement.style.overflow="hidden",a.modal=this.temModalAberto):(document.body.parentElement.style.overflow="",delete a.modal);router.push({query:a})},deep:!0}},data:function(){return{loading:!0,dbAddr:"",syncHandler:void 0,remoteDB:void 0,localDB:void 0,nomedb:void 0,sincronizando:null,instrumentState:INSTRUMENT_STORE.state,logged:null,
timeoutState:{}}},created:function(){this.checkLogin()},mounted:function(){},methods:{checkLogin:function(){var a=this;(new PouchDB(window.DB_ADDR+"_users",{skip_setup:!0,ajax:{timeout:5E3}})).getSession(function(b,c){if(b||!c.userCtx.name){a.nomedb=window.localStorage.getItem("nomedb");try{var d=JSON.parse(window.localStorage.getItem("userCtx"));a.nomedb&&d&&(a.logged=!0)}catch(e){console.log(e)}}else window.localStorage.setItem("userCtx",JSON.stringify(c.userCtx)),d=c.userCtx,a.logged=!0,b=/(__{1})(?!.*__)/g,
b.exec(d.roles[0]),a.nomedb=d.roles[0].substring(0,b.lastIndex-2),window.localStorage.setItem("nomedb",a.nomedb);a.remoteDB=new PouchDB(window.DB_ADDR+a.nomedb,{skip_setup:!0,ajax:{timeout:5E3}});INSTRUMENT_STORE.remoteDB=a.remoteDB;d&&a.nomedb?(INSTRUMENT_STORE.state.userCtx=d,INSTRUMENT_STORE.state.usuarioTemAdminRole=-1!==d.roles[0].indexOf("__admin"),/iPad|iPhone|iPod/.test(navigator.userAgent),a.localDB=new PouchDB(a.nomedb,{skip_setup:!0,adapter:"idb",auto_compaction:!0}),(INSTRUMENT_STORE.state.db=
a.localDB)&&a.remoteDB&&a.localDB.adapter!==a.remoteDB.adapter&&a.setSync(),a.logged&&a.queryInstrumentosData().then(a.getAnaliseFn).then(function(){a.$route.params.id||a.$router.push({path:"/instrumentos"});a.loading=!1})):(a.loading=!1,a.logged||a.$route.query.token||(a.instrumentState.isLanding="login"===a.$route.query.action?!1:!0))})},getAnaliseFn:function(a){var b=this;return(a||INSTRUMENT_STORE.state.db).get("_design/analise").then(function(a){INSTRUMENT_STORE.state.Analises=new Function("data",
"faixaSelecionada","analiseFaixaArg",fnTextoEntreTags(a.views.analise.reduce.toString(),"Analises"));a=new INSTRUMENT_STORE.state.Analises({config:[]},!0);INSTRUMENT_STORE.state.funcoes=JSON.parse(JSON.stringify(a.funcoes))}).catch(function(a){"missing"===a.reason?b.getAnaliseFn(b.remoteDB):console.log(a)})},queryInstrumentosData:function(a){var b=this;return(a||INSTRUMENT_STORE.state.db).query("instrumentos/lista").then(function(a){var c=a.rows.filter(function(a){return-1!==a.id.indexOf("_config_")}),
e={};a.rows.filter(function(a){return!!a.value.dataUltimaCal}).map(function(a){var d=c.filter(function(b){return b.key[0]===a.id}).map(function(a){return a.value});d=fnConfigPeriodicidade(d,a.value.AlPeriodoCalibracao,a.value.AlTipoPeriodo);d=fnPegaStatus(a.value.dataUltimaCal,d);b.$set(e,a.id,{status:d,descricao:fnDescItem(a.value),item:a.value,id:a.id})});INSTRUMENT_STORE.updateInstrumentos(e)}).catch(function(a){"missing"===a.reason?b.queryInstrumentosData(b.remoteDB):console.log(a)})},queryInstIdData:fnQueryInstIdData,
setSync:function(){var a=this;PouchDB.sync(this.localDB,this.remoteDB,{live:!0,retry:!0,filter:"suprimeAnexos/suprimeAnexos"}).on("change",function(b){b=b.change;if(b.docs.length){a.queryInstrumentosData();for(var c=0;c<b.docs.length;c++)if("config_"+a.$route.params.id===b.docs[c].type||"ocorr_"+a.$route.params.id===b.docs[c].type){var d=a.timeoutState[a.$route.params.id];d&&clearTimeout(d);a.timeoutState[a.$route.params.id]=setTimeout(function(){a.queryInstIdData()},500)}}}).on("paused",function(b){a.sincronizando=
!1}).on("active",function(){a.sincronizando=!0;console.log("sincronizando")}).on("denied",function(a){console.log("denied",a)}).on("complete",function(b){a.sincronizando=!1}).on("error",function(a){console.log("err",a)})}},computed:{temModalAberto:function(){var a=this.instrumentState.modals;return Object.keys(a).reduce(function(b,c){return b||a[c]},!1)}}})).$mount("#app");
document.onkeydown=function(a){a=a||window.event;var b=!1;(b="key"in a?"Escape"===a.key||"Esc"===a.key:27===a.keyCode)&&Object.keys(INSTRUMENT_STORE.state.modals).map(function(a){INSTRUMENT_STORE.state.modals[a]=!1})};
